# Описание проекта
Проект представляет собой backend-составляющую (API для twitter-подобного приложения) с возможностью постить твиты 
с картинками, ставить лайки, дизлайки, просматривать данные о себе и других пользователях, подписываться на других 
пользователей и просматривать ленту с твитами.

Предполагается, что у нас корпоративная сеть, а потому в сервисе нет возможности авторизации - 
аутентификация пользователей осуществляется через **токен в header**.

## Используемые инструменты
* **Python** (3.10);
* **FastApi** (asynchronous Web Framework);
* **Docker** and **Docker Compose** (containerization);
* **PostgreSQL** (database);
* **SQLAlchemy** (working with database from Python);
* **Alembic** (database migrations made easy);
* **Pydantic** (data verification);
* **Loguru** (logging);
* **Pytest** (tests);
* **Nginx** (server for linking frontend and backend).

## Сборка и запуск приложения
1. Переименовать .env.template в .env
2. Собрать и запустить контейнеры с приложением. В терминале в общей директории (с файлом "docker-compose.yml") 
вводим команду:
    ```
    docker-compose up -d
    ```
3. Запускаем скрипт внутри контейнера с API для заполнения БД демонстрационными данными:
    ```
    docker-compose exec app python3 -m main.demostration
    ```
В демонстрационных данных пользователи **test**, **test2** и **test3** уже подписаны друг на друга. 
Добавлены твиты с изображениями и лайки к записям.

## Документация

После сборки и запуска приложения ознакомиться с документацией API можно по адресу:
    ```
    localhost:8000/docs/
    ```


## Frontend

Для установки токена в header в правом верхнем углу frontend-ом предусмотрена форма для ввода api-key, 
по-умолчанию используется значение "test". После загрузки демонстрационны данных в БД будут сведения для 
пользователей с токенами "**test**", **test2**" и "**test3**". 
Все пользователи имеют данные с твитами, лайками и подписками.

## Тестирование

1. Необходимо изменить значение переменной окружения **DB_HOST**:
    ```
   DB_HOST=localhost
   ```
2. Запускаем в фоне контейнер с БД:
    ```
    docker-compose up postgres -d
    ```
3. Запускаем тесты:
    ```
    pytest -v
    ```
## Запуск приложения локально

1. Необходимо изменить значение переменной окружения **DB_HOST**:
    ```
   DB_HOST=localhost
   ```
2. Запускаем в фоне контейнер с БД:
    ```
    docker-compose up postgres -d
    ```
3. Выполняем команду:
    ```
    uvicorn main.app:app --proxy-headers --port 8000
    ```
